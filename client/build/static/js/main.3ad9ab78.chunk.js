(this["webpackJsonptodo-react"]=this["webpackJsonptodo-react"]||[]).push([[0],{134:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},148:function(e,t){},150:function(e,t){},163:function(e,t){},165:function(e,t){},193:function(e,t){},194:function(e,t){},199:function(e,t){},201:function(e,t){},208:function(e,t){},227:function(e,t){},257:function(e,t,n){"use strict";n.r(t);var s=n(4),a=n.n(s),c=n(124),r=n.n(c),o=(n(134),n(128)),i=n(3),u=n.n(i),l=n(9),h=n(125),p=n(126),d=n(129),j=n(127),f=(n(136),n(8)),m=(n(137),n(0));var b=function(e){var t=e.addTask,n=e.completeAll,a=e.isNotEmpty,c=e.isAllCompleted,r=Object(s.useState)(""),o=Object(f.a)(r,2),i=o[0],u=o[1];return Object(m.jsxs)("div",{id:"input",children:[Object(m.jsx)("button",{id:"completeAllBtn",onClick:n,className:c&&a?"completed ":a?"":"empty",children:"\xa0"}),Object(m.jsx)("form",{onSubmit:function(e){e.preventDefault(),i.trim()&&t(i),u("")},children:Object(m.jsx)("input",{type:"text",placeholder:"What needs to be done",value:i,onChange:function(e){u(e.currentTarget.value)}})})]})};n(139);function O(e){var t=e.id,n=e.isCompleted,a=e.deleteTask,c=e.changeCompleteness,r=e.changeTask,o=e.title,i=Object(s.useState)(!0),u=Object(f.a)(i,2),l=u[0],h=u[1],p=Object(s.useState)(o),d=Object(f.a)(p,2),j=d[0],b=d[1],O=function(e){console.log("blur"===e.type||"Enter"===e.key),"blur"!==e.type&&"Enter"!==e.key||(r(j,t),h(!0))};return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("li",{className:"taskElement",children:l?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("input",{type:"checkbox",className:"checkbox",onChange:function(){return c(t,!n)},checked:n}),Object(m.jsxs)("div",{id:"inputArea",onDoubleClick:function(){return h(!1)},children:[Object(m.jsx)("p",{className:n?"completed taskvalue":"uncompleted taskvalue",children:o}),Object(m.jsx)("button",{className:"delete",onClick:function(){return a(t)},children:"\xd7"})]})]}):Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("input",{className:"valueChanger",value:j,onChange:function(e){return b(e.currentTarget.value)},onKeyDown:O,onBlur:O,type:"text"})})})})}n(140);var g=function(e){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("hr",{}),Object(m.jsx)("ul",{children:e.tasks.length?e.tasks.map((function(t){return"all"===e.showCondition||"uncompleted"===e.showCondition&&!t.isCompleted||"completed"===e.showCondition&&t.isCompleted?Object(m.jsx)(O,{title:t.title,id:t.id,isCompleted:t.isCompleted,changeCompleteness:e.changeCompleteness,deleteTask:e.deleteTask,changeTask:e.changeTask},t.id):null})):Object(m.jsx)("p",{children:"No tasks"})})]})};n(141);var k=function(e){var t=e.clearCompleted,n=e.showActive,s=e.showAll,a=e.showCompleted,c=e.tasksCounter,r=e.showCondition;return e.logout,Object(m.jsxs)("div",{id:"footer",children:[Object(m.jsxs)("p",{className:"itemsLeft",children:[c.active," items left"]}),Object(m.jsxs)("ul",{className:"menu",children:[Object(m.jsx)("li",{className:"menuElement ".concat("all"===r?"active":"n"),onClick:function(){return s()},children:"All"}),Object(m.jsx)("li",{className:"menuElement ".concat("uncompleted"===r?"active":"n"),onClick:function(){return n()},children:"Active"}),Object(m.jsx)("li",{className:"menuElement ".concat("completed"===r?"active":"n"),onClick:function(){return a()},children:"Completed"})]}),Object(m.jsx)("button",{className:"footerBtn ".concat(c?"":"hidden"),onClick:function(){return t()},children:"Clear completed"})]})};n(142);var x=function(e){var t=Object(s.useState)(""),n=Object(f.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(""),o=Object(f.a)(r,2),i=o[0],h=o[1],p=Object(s.useState)(""),d=Object(f.a)(p,2),j=d[0],b=d[1],O=Object(s.useState)(""),g=Object(f.a)(O,2),k=g[0],x=g[1],C=function(){var t=Object(l.a)(u.a.mark((function t(n){var s,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,fetch("/login",{method:"POST",body:JSON.stringify({email:a,password:j}),headers:{"Content-Type":"application/json"}});case 4:return s=t.sent,t.next=7,s.json();case 7:(c=t.sent).errors?(h(c.errors.email),x(c.errors.password)):(localStorage.setItem("auth",JSON.stringify(c.token)),e.checkAuth()),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"login",children:Object(m.jsxs)("form",{onSubmit:C,children:[Object(m.jsx)("div",{className:"loginMenu",children:Object(m.jsx)("h2",{children:"Login"})}),Object(m.jsx)("label",{children:"Email"}),Object(m.jsx)("input",{type:"text",value:a,onChange:function(e){return c(e.currentTarget.value)}}),Object(m.jsx)("div",{className:"email error",children:i}),Object(m.jsx)("label",{children:"Password"}),Object(m.jsx)("input",{type:"password",value:j,onChange:function(e){return b(e.currentTarget.value)}}),Object(m.jsx)("div",{className:"password error",children:k}),Object(m.jsx)("button",{children:"Login"}),Object(m.jsx)("p",{onClick:e.setSignup,className:"link",children:"Don't have an account?"})]})})};n(143);var C=function(e){var t=Object(s.useState)(""),n=Object(f.a)(t,2),a=n[0],c=n[1],r=Object(s.useState)(""),o=Object(f.a)(r,2),i=o[0],h=o[1],p=Object(s.useState)(""),d=Object(f.a)(p,2),j=d[0],b=d[1],O=Object(s.useState)(""),g=Object(f.a)(O,2),k=g[0],x=g[1],C=Object(s.useState)(""),v=Object(f.a)(C,2),S=v[0],w=v[1],y=function(){var t=Object(l.a)(u.a.mark((function t(n){var s,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),j!==k){t.next=17;break}return t.prev=2,t.next=5,fetch("/signup",{method:"POST",body:JSON.stringify({email:a,password:j}),headers:{"Content-Type":"application/json"}});case 5:return s=t.sent,t.next=8,s.json();case 8:(c=t.sent).errors?(h(c.errors.email),w(c.errors.password)):e.setLogin(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0);case 15:t.next=18;break;case 17:w("Passwords don't match");case 18:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e){return t.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"signup",children:Object(m.jsxs)("form",{onSubmit:y,children:[Object(m.jsx)("div",{className:"signupMenu",children:Object(m.jsx)("h2",{children:"Signup"})}),Object(m.jsx)("label",{children:"Email"}),Object(m.jsx)("input",{type:"text",value:a,onChange:function(e){return c(e.currentTarget.value)}}),Object(m.jsx)("div",{className:"email error",children:i}),Object(m.jsx)("label",{children:"Password"}),Object(m.jsx)("input",{type:"password",value:j,onChange:function(e){return b(e.currentTarget.value)}}),Object(m.jsx)("div",{className:"password error",children:S}),Object(m.jsx)("label",{children:"Confirm password"}),Object(m.jsx)("input",{type:"password",value:k,onChange:function(e){return x(e.currentTarget.value)}}),Object(m.jsx)("button",{children:"Signup"}),Object(m.jsx)("p",{onClick:e.setLogin,className:"link",children:"Already have an account?"})]})})},v=n(144),S=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(h.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={tasks:[],showCondition:"all",tasksCounter:{all:0,completed:0,active:0},isLoggedin:!1,logOrSignUp:"login"},e.componentDidMount=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkAuth();case 2:case"end":return t.stop()}}),t)}))),e.checkAuth=Object(l.a)(u.a.mark((function t(){var n,s,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!localStorage.auth){t.next=11;break}return n=JSON.parse(localStorage.auth),t.next=4,fetch("/verifyToken",{method:"POST",body:JSON.stringify({token:n}),headers:{"Content-Type":"application/json"}});case 4:return s=t.sent,t.next=7,s.json();case 7:a=t.sent,e.setState({isLoggedin:a.status}),t.next=12;break;case 11:e.setState({isLoggedin:!1});case 12:if(!e.state.isLoggedin){t.next=15;break}return t.next=15,e.fetchTasks();case 15:case"end":return t.stop()}}),t)}))),e.fetchTasks=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:fetch("/tasks/",{method:"GET",headers:{authorization:JSON.parse(localStorage.auth)}}).then((function(e){return e.json()})).then(function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({tasks:n});case 2:e.stateTasksCounter();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e.setSignup=function(){return e.setState({logOrSignUp:"signup"})},e.setLogin=function(){return e.setState({logOrSignUp:"login"})},e.logout=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({tasks:[]});case 2:return t.next=4,localStorage.removeItem("auth");case 4:return t.next=6,e.checkAuth();case 6:case"end":return t.stop()}}),t)}))),e.addTask=function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/tasks/",{headers:{Accept:"application/json","Content-Type":"application/json",authorization:JSON.parse(localStorage.auth)},method:"POST",body:JSON.stringify({title:n})}).catch((function(e){console.log(e)}));case 2:return t.next=4,e.fetchTasks();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.findIndexById=function(t){for(var n=0;n<e.state.tasks.length;n++)if(t===e.state.tasks[n].id)return n},e.stateTasksCounter=function(){e.setState({tasksCounter:{all:e.state.tasks.length,completed:e.state.tasks.reduce((function(e,t){return e+t.isCompleted}),0),active:e.state.tasks.reduce((function(e,t){return e+!t.isCompleted}),0)}})},e.changeCompleteness=function(){var t=Object(l.a)(u.a.mark((function t(n,s){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/tasks/",{headers:{Accept:"application/json","Content-Type":"application/json",authorization:JSON.parse(localStorage.auth)},method:"PATCH",body:JSON.stringify([{id:n,setComplete:s}])});case 2:return t.next=4,e.fetchTasks();case 4:e.stateTasksCounter();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.deleteTask=function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/tasks/",{headers:{Accept:"application/json","Content-Type":"application/json",authorization:JSON.parse(localStorage.auth)},method:"DELETE",body:JSON.stringify([n])});case 2:return t.next=4,e.fetchTasks();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.changeTask=function(){var t=Object(l.a)(u.a.mark((function t(n,s){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/tasks/",{headers:{Accept:"application/json","Content-Type":"application/json",authorization:JSON.parse(localStorage.auth)},method:"PATCH",body:JSON.stringify([{id:s,title:n}])});case 2:return t.next=4,e.fetchTasks();case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.completeAll=Object(l.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=Object(o.a)(e.state.tasks))[0].setComplete=!1,n.forEach((function(e){e.isCompleted||(n[0].setComplete=!0)})),t.next=5,fetch("/tasks/",{headers:{Accept:"application/json","Content-Type":"application/json",authorization:JSON.parse(localStorage.auth)},method:"PATCH",body:JSON.stringify(n.map((function(e){return e.hasOwnProperty("setComplete")?{id:e.id,setComplete:e.setComplete}:{id:e.id}})))});case 5:return t.next=7,e.fetchTasks();case 7:e.stateTasksCounter();case 8:case"end":return t.stop()}}),t)}))),e.clearCompleted=Object(l.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.tasks.filter((function(e){return!e.isCompleted})),fetch("/tasks/",{headers:{Accept:"application/json","Content-Type":"application/json",authorization:JSON.parse(localStorage.auth)},method:"DELETE",body:JSON.stringify(e.state.tasks.filter((function(e){return-1===n.indexOf(e)})).map((function(e){return e.id})))}),t.next=4,e.fetchTasks();case 4:e.stateTasksCounter();case 5:case"end":return t.stop()}}),t)}))),e.showActive=function(){return e.setState({showCondition:"uncompleted"})},e.showAll=function(){return e.setState({showCondition:"all"})},e.showCompleted=function(){return e.setState({showCondition:"completed"})},e}return Object(p.a)(n,[{key:"render",value:function(){return localStorage.auth&&!this.state.isLoggedin?Object(m.jsx)(m.Fragment,{}):Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)("h1",{children:"todos"}),this.state.isLoggedin&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("p",{className:"username",children:["Logged as ",v.decode(JSON.parse(localStorage.auth)).email," ",Object(m.jsxs)("span",{onClick:this.logout,className:"logout",children:[" ","Logout"," "]})]}),Object(m.jsx)(b,{addTask:this.addTask,completeAll:this.completeAll,isAllCompleted:this.state.tasksCounter.all===this.state.tasksCounter.completed,isNotEmpty:this.state.tasksCounter.all}),!!this.state.tasks.length&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(g,{tasks:this.state.tasks,changeCompleteness:this.changeCompleteness,showCondition:this.state.showCondition,deleteTask:this.deleteTask,taskElemHandler:this.taskElemHandler,changeTask:this.changeTask}),Object(m.jsx)(k,{clearCompleted:this.clearCompleted,showActive:this.showActive,showAll:this.showAll,showCompleted:this.showCompleted,showCondition:this.state.showCondition,tasksCounter:this.state.tasksCounter,logout:this.logout})]})]}),!this.state.isLoggedin&&"login"===this.state.logOrSignUp&&Object(m.jsx)(x,{checkAuth:this.checkAuth,setSignup:this.setSignup}),!this.state.isLoggedin&&"signup"===this.state.logOrSignUp&&Object(m.jsx)(C,{checkAuth:this.checkAuth,setLogin:this.setLogin})]})}}]),n}(a.a.Component),w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,258)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),s(e),a(e),c(e),r(e)}))};r.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(S,{})}),document.getElementById("root")),w()}},[[257,1,2]]]);
//# sourceMappingURL=main.3ad9ab78.chunk.js.map